<div class="tag-page">
    <div class="container">
        <div class="page-header">
            <h1>标签: <%= page.tag %></h1>
            <p class="lead">共 <%= page.posts.length %> 篇文章</p>
        </div>

        <div class="articles-grid">
            <% page.posts.each(function(post) { %>
            <article class="article-card">
                <% if (post.thumbnail) { %>
                <a href="<%= url_for(post.path) %>">
                    <img src="<%= post.thumbnail %>" alt="<%= post.title %>" class="article-image" loading="lazy">
                </a>
                <% } else if (post.photos && post.photos.length > 0) { %>
                <a href="<%= url_for(post.path) %>">
                    <img src="<%= post.photos[0] %>" alt="<%= post.title %>" class="article-image" loading="lazy">
                </a>
                <% } else { %>
                <a href="<%= url_for(post.path) %>">
                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23667eea;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%23764ba2;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect fill='url(%23grad)' width='800' height='600'/%3E%3Ctext fill='%23ffffff' x='50%25' y='50%25' text-anchor='middle' dominant-baseline='middle' font-family='Arial, sans-serif' font-size='24'%3E<%= post.title %>%3C/text%3E%3C/svg%3E" alt="<%= post.title %>" class="article-image image-fallback" loading="lazy">
                </a>
                <% } %>
                <div class="article-content">
                    <div class="article-meta">
                        <span class="article-category"><%= post.category || '未分类' %></span>
                        <span class="article-date"><%= date(post.date, 'YYYY-MM-DD') %></span>
                    </div>
                    <h3 class="article-title">
                        <a href="<%= url_for(post.path) %>"><%= post.title %></a>
                    </h3>
                    <p class="article-excerpt">
                        <%= truncate(strip_html(post.content), {length: 100, omission: '...'}) %>
                    </p>
                </div>
            </article>
            <% }); %>
        </div>

        <%- partial('_partial/pagination') %>
    </div>
</div>
